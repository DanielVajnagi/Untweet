<li class="tweet-item" data-controller="dropdown" data-turbo-stream-target="tweet">
  <%= turbo_stream_from "tweets" %>
  <%= link_to tweet.is_retweet? ? tweet_path(tweet.original_tweet) : tweet_path(tweet), class: "tweet-link" do %>
    <% if tweet.is_retweet? %>
      <div class="tweet-retweet-banner">
        <span class="tweet-retweet-icon">‚Ü™</span>
        <span class="tweet-retweet-text">
          <%= tweet.user.username %> <%= t('tweets.retweeted_by') %> <%= time_ago_in_words_localized(tweet.created_at) %>
        </span>
      </div>
    <% end %>

    <div class="tweet-content">
      <div class="tweet-header-container">
        <div class="tweet-header-content">
          <span class="tweet-author">
            <% if tweet.is_retweet?%>
              <%= tweet.original_tweet.user.username %>
            <% else %>
              <%= tweet.user.username %>
            <% end %>
          </span>
          <span class="tweet-time">¬∑
            <% if tweet.is_retweet?%>
              <%= time_ago_in_words_localized(tweet.original_tweet.created_at) %>
            <% else %>
              <%= time_ago_in_words_localized(tweet.created_at) %>
            <% end %>
          </span>
          <% if tweet.updated_at != tweet.created_at %>
            <span class="tweet-edited">¬∑ <%= t('tweets.edited') %></span>
          <% end %>
        </div>
      </div>

      <% if tweet.is_quote? %>
        <%= render 'tweets/quote_tweet', tweet: tweet %>
      <% else %>
          <p class="tweet-body">
            <% if tweet.is_retweet? %>
              <% if tweet.original_tweet.is_quote? %>
                <%= render 'tweets/quote_tweet', tweet: tweet.original_tweet %>
              <% else %>
                <%= tweet.original_tweet.body %>
              <% end %>
            <% else %>
              <%= tweet.body %>
            <% end %>
          </p>
      <% end %>
    </div>
  <% end %>

  <div class="tweet-actions">
    <div class="tweet-action-button">
      <%= button_to "#", method: :post, class: 'tweet-action tweet-comment', title: t('tweets.reply') do %>
        <span class="tweet-action-icon">üí¨</span>
        <span class="tweet-action-count">12</span>
      <% end %>
    </div>

    <div class="tweet-action-button" data-dropdown-target="container">
      <button type="button"
              class="tweet-action tweet-retweet"
              data-action="click->dropdown#toggle"
              title="<%= t('tweets.retweet') %>">
        <span class="tweet-action-icon">‚Ü™</span>
        <span class="tweet-action-count">
          <% if tweet.is_retweet? %>
            <%= tweet.original_tweet.retweet_count %>
          <% else %>
            <%= tweet.retweet_count %>
          <% end %>
        </span>
      </button>

      <div class="share-menu" data-dropdown-target="menu">
        <%= link_to retweet_tweet_path(tweet),
            class: "share-option",
            data: { "turbo-method": :post } do %>
          <span class="share-option-icon">‚Ü™</span>
          <%= t('tweets.retweet') %>
        <% end %>

        <%= link_to new_quote_tweet_path(tweet),
            class: "share-option" do %>
          <span class="share-option-icon">üí≠</span>
          <%= t('tweets.quote') %>
        <% end %>
      </div>
    </div>

    <div class="tweet-action-button">
      <%= render 'tweets/like_button', tweet: tweet %>
    </div>

    <% if tweet.author?(current_user) %>
      <% unless tweet.is_retweet? %>
        <div class="tweet-action-button">
          <%= link_to edit_tweet_path(tweet), class: 'tweet-action tweet-edit', title: t('tweets.edit') do %>
            <span class="tweet-action-icon">‚úèÔ∏è</span>
          <% end %>
        </div>
      <% end %>

      <div class="tweet-action-button">
        <%= button_to tweet_path(tweet), method: :delete, data: { turbo_confirm: t('tweets.confirm_delete') }, class: 'tweet-action tweet-delete', title: t('tweets.delete') do %>
          <span class="tweet-action-icon">üóëÔ∏è</span>
        <% end %>
      </div>
    <% end %>
  </div>
</li>
