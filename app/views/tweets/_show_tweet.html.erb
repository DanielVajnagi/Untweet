<div class="tweet-content" data-turbo-stream-target="tweet">
  <%= turbo_stream_from "tweets" %>
  <div class="tweet-header-container">
    <div class="tweet-header-content">
      <span class="tweet-author">
        <% if tweet.is_retweet?%>
          <%= link_to user_path(tweet.original_tweet.user.username), class: "tweet-author-link" do %>
            <%= tweet.original_tweet.user.username %>
          <% end %>
        <% else %>
          <%= link_to user_path(tweet.user.username), class: "tweet-author-link" do %>
            <%= tweet.user.username %>
          <% end %>
        <% end %>
      </span>
    </div>
  </div>

  <% if tweet.is_quote? %>
    <%= render 'tweets/quote_tweet', tweet: tweet %>
  <% else %>
    <p class="tweet-body">
      <% if tweet.is_retweet? %>
        <%= tweet.original_tweet.body %>
      <% else %>
        <%= tweet.body %>
      <% end %>
    </p>
  <% end %>

  <div class="tweet-full-time">
    <div class="tweet-time-text text-gray-500"><%= t('tweets.created_on', time: l(tweet.created_at, format: :long)) %></div>
    <% if tweet.updated_at != tweet.created_at %>
      <div class="tweet-time-text text-gray-500 mt-1"><%= t('tweets.edited_on', time: l(tweet.updated_at, format: :long)) %></div>
    <% end %>
  </div>

  <div class="tweet-actions" data-controller="dropdown">
    <div class="tweet-action-button">
      <%= link_to "#", class: 'tweet-action tweet-comment', title: t('tweets.reply') do %>
        <i class="fa-regular fa-comment text-lg"></i>
        <%= render 'tweets/comment_count', tweet: tweet %>
      <% end %>
    </div>

    <div class="tweet-action-button">
      <button type="button"
              class="tweet-action tweet-retweet"
              data-action="click->dropdown#toggle"
              title="<%= t('tweets.retweet') %>">
        <i class="fa-solid fa-retweet text-lg"></i>
        <%= render 'tweets/retweet_count', tweet: tweet %>
      </button>

      <div class="share-menu" data-dropdown-target="menu">
        <%= link_to retweet_tweet_path(tweet),
            class: "share-option",
            data: { "turbo-method": :post } do %>
          <i class="fa-solid fa-retweet text-lg"></i>
          <%= t('tweets.retweet') %>
        <% end %>

        <%= link_to new_quote_tweet_path(tweet),
            class: "share-option" do %>
          <i class="fa-solid fa-quote-right text-lg"></i>
          <%= t('tweets.quote') %>
        <% end %>
      </div>
    </div>

    <%= render 'tweets/like_button', tweet: tweet %>

    <% if tweet.author?(current_user) %>
      <div class="tweet-action-button">
        <%= link_to edit_tweet_path(tweet), class: 'tweet-action tweet-edit', title: 'Edit Tweet' do %>
          <i class="fa-regular fa-pen-to-square text-lg"></i>
        <% end %>
      </div>

      <div class="tweet-action-button">
        <%= button_to tweet_path(tweet), method: :delete, data: { turbo_confirm: 'Are you sure?' }, class: 'tweet-action tweet-delete', title: 'Delete Tweet' do %>
          <i class="fa-regular fa-trash-can text-lg"></i>
        <% end %>
      </div>
    <% end %>
  </div>
</div>